// Generated by CoffeeScript 1.6.2
(function() {
  $($(function() {
    var $body, current_task, handle_task, set_background_blur, update_countdown;

    $body = $('body');
    current_task = null;
    set_background_blur = function(intensity) {
      return $('.background-wrapper').css('-webkit-filter', 'blur(' + (intensity * 10).toFixed(4) + 'px)').css('-webkit-transform', 'scale(' + (1 + intensity * 0.5).toFixed(4) + ')');
    };
    update_countdown = function() {
      $('#timer-countdown').text(current_task.countdown + ' seconds');
      set_background_blur(current_task.countdown / current_task.time);
      if (current_task.countdown > 0) {
        current_task.countdown -= 1;
        return window.setTimeout(update_countdown, 1000);
      } else {
        $('#taskbutton').show();
        return $('#timer').hide();
      }
    };
    handle_task = function(task) {
      $('#timer').show();
      $('#taskdisplay').text(task.title);
      $('.background-wrapper').css('background-image', 'url(' + task.image.url + ')');
      $('#imagecredits').html(task.image.credits);
      $('#taskbutton').hide();
      task.countdown = task.time;
      current_task = task;
      return update_countdown();
    };
    return $('#taskbutton').click(function(e) {
      e.preventDefault();
      return $.getJSON('/task.json', function(task) {
        return handle_task(task);
      });
    });
  }));

}).call(this);
